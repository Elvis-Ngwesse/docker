# ---------------------------------------------------------
# 📚 What Are Docker Volumes?
# ---------------------------------------------------------

Docker **volumes** are the preferred way to persist data used or generated by Docker containers.

They allow you to:
- Retain data between container restarts or removals
- Share data between multiple containers
- Avoid tying your container’s state to the host filesystem directly

On Linux, Docker stores volume data in:

    /var/lib/docker/volumes/

> 📌 On macOS and Windows, Docker runs in a virtual Linux environment (VM), so this path exists **inside** the VM, not on your native filesystem.

---

# ---------------------------------------------------------
# 🧰 Scenario: Static Website with Custom Nginx Config
# ---------------------------------------------------------

You're deploying a **static website** using Docker and Nginx.

Your goals:
- ✅ Serve custom **HTML and CSS** files
- ✅ Use a custom `nginx.conf` file for advanced configuration
- ✅ Ensure all files are stored using **Docker volumes**, so nothing is lost between runs

---

# ---------------------------------------------------------
# 🐳 Setup
# ---------------------------------------------------------

You will use **Docker Compose** to define and run two services:

1. `init` – used to copy your local HTML and config files into Docker volumes
2. `nginx` – serves the website using the copied files

---

# ---------------------------------------------------------
# 🛠 How It Works
# ---------------------------------------------------------

### 🔧 Init Service
- Mounts local folders `./html` and `./nginx` as **read-only**
- Copies the contents into Docker volumes:
  - `html-data`
  - `nginx-config`
- Runs **once**, performs the copy, and exits

### 🌐 Nginx Service
- Waits for `init` to finish via `depends_on`
- Reads data from the two volumes:
  - HTML files from `html-data`
  - Configuration from `nginx-config`

This separation ensures that:
- You can freely change your local files without affecting running containers
- Volumes persist even if containers are removed or restarted

---

# ---------------------------------------------------------
# 🚀 How to Run It
# ---------------------------------------------------------

Run this command from the directory containing `docker-compose.yaml`:

```bash
docker compose -f docker-volume/docker-compose.yaml up --build --force-recreate
```

---------------------------------------------------------
✅ Open in Browser
---------------------------------------------------------

Visit:

http://localhost:8080

You should see your static website running.

---------------------------------------------------------
📦 Working with Volumes
---------------------------------------------------------

🔍 List Volumes
- docker volume ls
🔍 Inspect a Volume
- docker volume inspect docker-volume_html-data
Look for the "Mountpoint" field, like:
"Mountpoint": "/var/lib/docker/volumes/docker-volume_html-data/_data"
This is the actual path (inside Docker’s Linux VM) where volume files are stored.

---------------------------------------------------------
📁 What the Mountpoint Means
---------------------------------------------------------
When you see a mount point like:
/var/lib/docker/volumes/docker-volume_html-data/_data
This means Docker stores the volume's content here inside its internal Linux filesystem.
When you mount the volume in a container using:
-v html-data:/usr/share/nginx/html

Docker maps:
/var/lib/docker/volumes/docker-volume_html-data/_data
➡️ to:
/usr/share/nginx/html
inside the container.
So any file written by the container to `/usr/share/nginx/html` will be stored in the volume.

---------------------------------------------------------
🔍 How to Access Volume Data
---------------------------------------------------------

✅ Method: Use a Temporary Container
You can inspect the volume safely using a throwaway container:
docker run --rm -it -v docker-volume_html-data:/data alpine sh
Once inside:
cd /data  
ls -la  
cat index.html
✅ This method works on Linux, macOS, and Windows — regardless of where Docker stores internal volume data.
